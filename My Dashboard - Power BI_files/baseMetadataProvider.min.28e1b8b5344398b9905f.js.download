var powerbi;function addOrUpdateQueryString(e,t,n=window.location.search){let a=parseQueryString(n);return a[e]=t,rebuildQueryString(a)}function clearQueryString(e,t=window.location.search){let n=parseQueryString(t);return delete n[e],rebuildQueryString(n)}function parseQueryString(e=window.location.search){let n={},t=e;var a;if(t&&"?"===t.substr(0,1))for(a of t.substr(1).split("&")){let[e,...t]=a.split("=");var o=t.join("=");n[decodeURIComponent(e)]=decodeURIComponent(o)}return n}function rebuildQueryString(e){let t="",n=!0;for(var a in e)n||(t+="&"),t+=encodeURIComponent(a)+"=",e[a]&&(t+=encodeURIComponent(e[a])),n=!1;return n||(t="?"+t),t}function setCookie(e,t,n="/",a="none",o){o||(o=new Date).setFullYear(o.getFullYear()+1),window&&window.document&&(window.document.cookie=e+" = "+t+";secure;partitioned;path="+n+";expires="+o.toUTCString()+";samesite="+a)}function startBaseMetadataLogRequest(e,t,n){t={url:e,start:new Date,requestId:t};return window[n].push(t),t}function endBaseMetadataLogRequest(e,t,n,a,o,r,i){e.end=new Date,e.isError=t,e.code=n,e.errorMessage=a,e.parseStart=r,e.parseEnd=i,e.size=o}function getBaseMetadata(n){const a=window;return new Promise((e,t)=>{a.clientAuthEnabled?a.signInPromise.then(()=>{window.baseMetadataFromClient?getBaseMetadataInternal(!1,n).then(()=>{e(!0)}).catch(()=>{e(!0)}):e(!0)}).catch(()=>{t(!0)}):window.baseMetadataFromClient?getBaseMetadataInternal(!1,n).then(()=>{e(!0)}).catch(()=>{e(!0)}):e(!0)})}function getBaseMetadataInternal(C,L){const R=window;return new Promise((h,b)=>{let e=window.clusterUri;var t=("/"===e.substring(e.length-1)?e:e+"/")+"metadata/bootstrap/base",n=C?window.baseMetadataRetryRequestId:window.baseMetadataRequestId;let S=startBaseMetadataLogRequest(t,n,"getBaseMetadataInfo");try{let m=new XMLHttpRequest;m.open("GET",t,!0),m.setRequestHeader("Accept","application/json"),m.setRequestHeader("Authorization","Bearer "+window.powerBIAccessToken),m.setRequestHeader("ActivityId",window.telemetrySessionId),m.setRequestHeader("RequestId",n),m.setRequestHeader("X-PowerBI-Auto-License-Info","AutoLicenseAssignmentSupported"),null!==window.aadConsistencyHeaderScenarioId&&""!==window.aadConsistencyHeaderScenarioId&&m.setRequestHeader("ConsistencyLevel","Organization;ScenarioId="+window.aadConsistencyHeaderScenarioId),null!==powerbi.getQueryStringValue("redirectedFromSignup")&&m.setRequestHeader("X-PowerBI-RedirectedFromSignup","true"),m.onreadystatechange=async function(){let a;try{if(m.readyState===XMLHttpRequest.DONE){a=m.status;let n=m.getAllResponseHeaders();if(200<=a&&a<300||304===a){var t=new Date;const p=JSON.parse(m.responseText);var o,r,i,s,d=new Date;window.powerbi;if(window.featureSwitches=p.clientFeatureSwitches,window.navPreferences=p.navPreferences,window.placeExpAssignmentContextOnPage&&(window.expAssignmentContext=p.expAssignmentContext),p&&p.branding&&p.branding.config){let n=JSON.parse(p.branding.config),a={},e=Object.keys(n);e.forEach(e=>{var t=e[0].toLowerCase()+e.substring(1);a[t]=n[e]}),p.branding.config=a}if(window.placeBrandingInfoOnPage&&(window.brandInfo=p.branding),window.placeAutoLicenseAssignmentStateOnPage){let e;!n||-1===n.indexOf("x-powerbi-auto-license-info")&&-1===n.indexOf("X-PowerBI-Auto-License-Info")||(e=m.getResponseHeader("x-powerbi-auto-license-info"));let t=!1;e&&e.toLowerCase()==="AutoLicenseAssignmentSucceeded".toLowerCase()&&(l=-1!==L.href.indexOf("/teams"),f=function(e){for(var t of["iphone","ipad","android"])if(e.toLowerCase().includes(t))return!0;return!1}(window.navigator.userAgent),l&&f&&(L.href="/TeamsMobileAutoLicense?originalUrl="+encodeURIComponent(L.href)),t=!0),v()&&(v().hasAutoAssignedLicense=t),window.hasAutoAssignedLicense=t}let e=p.userSettings.preferredLanguage;e&&0<e.length?(setCookie("PreferredLanguage",e),e.toLowerCase()!==I().toLowerCase()&&null===powerbi.getQueryStringValue("language")&&(o=L.origin+L.pathname,r=addOrUpdateQueryString("language",e,L.search),L.href=o+r)):""===e&&(setCookie("PreferredLanguage",e),window.navigator&&window.navigator.language&&window.navigator.language.toLowerCase()!==I().toLowerCase()&&null===powerbi.getQueryStringValue("language")&&(i=L.origin+L.pathname,s=addOrUpdateQueryString("language",window.navigator.language,L.search),L.href=i+s)),endBaseMetadataLogRequest(S,!1,a.toString(),void 0,m.responseText.length,t,d),h(p)}else if(isCAEClaimChallenge(a,m)&&R.teamsCAE&&("Teams"===R.hostPlatformName||"TeamsModern"===R.hostPlatformName||!0===R.inTeams)){var u;for(u of[R.metaOSAccessTokenKeyPrefix+R.hostPlatformName+"_"+R.hostPlatformType,R.metaOSUserInfoKeyPrefix+R.hostPlatformName+"_"+R.hostPlatformType])window.localStorage.removeItem(u);let e=new URL(L.href);e.searchParams.append("TeamsCAEinWFE","true"),L.href="/teams/TeamsAuthentication?"+encodeURIComponent(e.toString())}else{let t;if(!n||-1===n.indexOf("x-powerbi-error-info")&&-1===n.indexOf("X-PowerBI-Error-Info")||(t=m.getResponseHeader("x-powerbi-error-info")),0===a&&!t&&window.navigator&&(t="NavigatorOnLineProperty="+window.navigator.onLine),0===a||404===a||408===a||500<=a&&a<600)if(C)endBaseMetadataLogRequest(S,!0,a.toString(),t,void 0,void 0,void 0),b(t);else if(0===a)setTimeout(async()=>{try{var e=await getBaseMetadataInternal(!0,L);h(e)}catch(e){b(e)}},1e3);else try{var e=await getBaseMetadataInternal(!0,L);h(e)}catch(e){b(e)}else if(t&&t.toLowerCase()==="UserNotLicensed".toLowerCase()){endBaseMetadataLogRequest(S,!0,a.toString(),t,void 0,void 0,void 0);let e;if(!n||-1===n.indexOf("x-powerbi-auto-license-info")&&-1===n.indexOf("X-PowerBI-Auto-License-Info")||(e=m.getResponseHeader("x-powerbi-auto-license-info")),e&&e.toLowerCase()==="AutoLicenseAssignmentDisabledByTenant".toLowerCase())L.href="https://aka.ms/pbiAdHocSubscriptionNotAllowed";else{var w=window.staticPageRedirectInTeams,c=powerbi.getQueryStringValue("route"),g=-1!==L.href.indexOf("/teams/");let e,t;e=c&&0<c.length?(t=clearQueryString("route",L.search),L.origin+"/"+c):(t=L.search,L.origin+L.pathname),L.href=g&&w?"/StaticTeamsSignUp?originalUrl="+encodeURIComponent(L.href)+"&redirectUrl="+encodeURIComponent(e+t):"/SignupRedirect?ru="+e+t}b(t)}else endBaseMetadataLogRequest(S,!0,a.toString(),t,void 0,void 0,void 0),b(t)}}}catch(e){S.end||endBaseMetadataLogRequest(S,!0,a.toString(),e.message,void 0,void 0,void 0),b(e.message)}var l,f},m.send()}catch(e){S.end||endBaseMetadataLogRequest(S,!0,"No status code",e.message,void 0,void 0,void 0),b(e.message)}function v(){return function(){let e=a();e.session||(e.session={});return e.session}().userInfo}function I(){return function(){let e=a();e.common||(e.common={});return e.common}().cultureInfo}function a(){return window.powerbi||(window.powerbi={}),window.powerbi}})}(powerbi||(powerbi={})).getQueryStringValue=function(n,e){let a=(e=e||window.location.search).substr(1).split("&");for(let e=0,t=a.length;e<t;++e){var o=a[e].split("=");if(o[0]===n)return decodeURIComponent(o[1])}return null};const baseMetadataWindow=window;function isCAEClaimChallenge(e,t){const n=t.getResponseHeader("WWW-Authenticate");return 401===e&&n?.includes("error")}baseMetadataWindow.getBaseMetadataInfo=[],baseMetadataWindow.deferBaseMetadataPromise?baseMetadataWindow.getBaseMetadata=getBaseMetadata:baseMetadataWindow.baseMetadataPromise=getBaseMetadata(window.location);